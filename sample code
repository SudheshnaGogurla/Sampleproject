

Function delrows()
'        Dim ws3 As Worksheet
'
'        Set ws3 = ThisWorkbook.Sheets("GSAM")
'        ilimit = ws3.UsedRange.Rows.Count
'        For k = 2 To ilimit
'            ws3.Cells(2, 1).EntireRow.Delete
'        Next
        
        Worksheets("Plan").Rows(5 & ":" & Worksheets("Plan").Rows.Count).Delete

End Function

 totRows = Sheets("Plan").Range("E" & Sheets("Plan").Rows.Count).End(xlUp).Row
        
       Set WB = ThisWorkbook.Sheets("Plan")
       
        sRest = ""
  Jquery = Sheets("Plan").Cells(2, 6)
  GetUrl = "http://test.jira.services.test.com/jira"
  Call URLEncode(Jquery, Query)
  ApiUrl = GetUrl + "/rest/api/2/search?jql=" + Query + "&startAt=" + _
                        CStr(startAt) + "&maxResults=" + _
                        CStr(maxResults) & "&fields=customfield_15744,customfield_15628,customfield_15621,customfield_12683,customfield_15725,customfield_11770,customfield_15921,priority,status,key,summary,assignee,reporter,created,resolutiondate,duedate"

'  ApiUrl = GetUrl + "/rest/api/2/search?jql=" + Query + "&startAt=" + _
'                        CStr(startAt) + "&maxResults=" + _
'                        CStr(maxResults)
       
       With oJiraService
    .Open "GET", ApiUrl, False
    .setRequestHeader "Content-Type", "application/json"
    '.setRequestHeader "Accept", "application/json"
    .send
    sRest = .responseText
    sStatus = .Status & " | " & .statusText
  End With
  
  
  Function regExpression(ByVal strexp, ByRef strChkval)

     Dim objRegExp As Regexp
     Set objRegExp = New Regexp
     objRegExp.IgnoreCase = True
     objRegExp.Global = True
     objRegExp.Pattern = "\>(.*?)\<"
     Set Matches = objRegExp.Execute(strexp)
     'Get the results by using a For Loop
     For Each Match In Matches
         strChkval = Replace(strChkval + Match.Value, ">", "")
          strChkval = Trim(Left(strChkval, Len(strChkval) - 1))
     Next
End Function
Function sbVBS_To_Delete_EntireColumn_For_Loop()
    Set iWS = ThisWorkbook.Sheets("LD_Result")
    lColumn = iWS.UsedRange.Columns.Count
    For iCntr = 2 To lColumn
    iWS.Columns(2).EntireColumn.Delete
    Next
End Function

  Set objMail = CreateObject("CDO.Message")
Set objConf = CreateObject("CDO.Configuration")
Set objFlds = objConf.Fields

'Set various parameters and properties of CDO object
objFlds.Item("http://schemas.microsoft.com/cdo/configuration/sendusing") = 2 'cdoSendUsingPort
'your smtp server domain or IP address goes here such as smtp.yourdomain.com
objFlds.Item("http://schemas.microsoft.com/cdo/configuration/smtpserver") = "LonAnonSMTPRelay.internal.xxx.com" 
objFlds.Item("http://schemas.microsoft.com/cdo/configuration/smtpserverport") = 25 'default port for email
'uncomment next three lines if you need to use SMTP Authorization
objFlds.Item("http://schemas.microsoft.com/cdo/configuration/sendusername") = "dd@gm.com"
objFlds.Item("http://schemas.microsoft.com/cdo/configuration/sendpassword") = "TestPass"
objFlds.Item("http://schemas.microsoft.com/cdo/configuration/smtpauthenticate") = 2 'cdoBasic
objFlds.Update
objMail.Configuration = objConf
objMail.From = "dd@gm.com"
objMail.To = "dd@gm.com"
objMail.Subject = " Status"
strMessgaeBody= "Find enclosed invoice status sheet" & vbCrLf 
'strMessgaeBody= strMessgaeBody+ "Thanks " & vbCrLf 
"
objMail.TextBody = strMessgaeBody
objMail.AddAttachment sTestScript
objMail.Send

'Set all objects to nothing after sending the email
Set objFlds = Nothing
Set objConf = Nothing
Set objMail = Nothing
  
VBA References

Delete

Sheets("input_JbaCandidateCreation").Range(DeleteRangeJson).ClearContents


Count

Sheets("600ExistingDupCandidate").Range("A" & Sheets("600ExistingDupCandidate").Rows.Count).End(xlUp).Row

Open Fetch and delete data

Sub GetandDeleteData()

Application.ScreenUpdating = False
Dim ogwb As Workbook
Set ogwb = ThisWorkbook
Dim wb As Workbook
Dim rng As Range
Dim ws As Worksheet

''Calculate no of rows
strTotalRows = Sheets("Source").Range("A" & Sheets("Source").Rows.Count).End(xlUp).Row
Mainpath = Sheets("Source").Cells(1, 3)

DeleteRangeJson = "C3:T" & strTotalRows

On Error Resume Next
Sheets("Source").Range(DeleteRangeJson).ClearContents
On Error GoTo 0

For intsheets = 3 To strTotalRows
      
    countryName = Right(Sheets("Source").Cells(intsheets, 1), 3)
    scriptName = Sheets("Source").Cells(intsheets, 1)
    DeleteRowFlag = Sheets("Source").Cells(intsheets, 2)
    Path = Mainpath & countryName & "\" & scriptName & ".csv"
    Set wb = Workbooks.Open(Filename:=Path)
    open_file = wb.Name
    Set wb = Workbooks(open_file)
    Set ws = wb.Worksheets(1)
    LastRow = ws.Cells(Rows.Count, "A").End(xlUp).Row
    readcolumns = ""
    If LastRow > 1 Then
    
         Intcolumn = 3
         For i = 1 To 30
           Output = ws.Cells(LastRow, i).Value
            If Output <> "" Then
             ogwb.Activate
             Sheets("Source").Cells(intsheets, Intcolumn) = Output
             Intcolumn = Intcolumn + 1
            End If
         Next
         
         'Delete Last row
         StrRange = "A" & LastRow
         If DeleteRowFlag = "Yes" Then
          ws.Range(StrRange).EntireRow.Delete
         End If
    End If
    wb.Close SaveChanges:=True

Next

MsgBox "Completed"


End Sub

'Columncount

colCountInMacro = Sheets("Macro").Cells(intRowcount, Columns.Count).End(xlToLeft).Column

Find row in column

Set rngFound = Sheets("Logins_FE").Columns("A").Find(Trim(countryName), Cells(Rows.Count, "A"), xlValues, xlWhole)
     RowstartCountryFind = rngFound.Row

After some range second one

Set cell = Sheets("Logins_FE").Range(StrRange).Find(Trim(countryName), After:=Range(AftercellRange))
        FoundinRow = cell.Row
        Set cell = Nothing
Copy range and paste and delete

Sheets("Scalability_Input").Activate
	Sheets("Scalability_Input").Activate
lastColumn = Sheets("Scalability_Input").Cells(scalabilityReferenceRow - 1, Columns.Count).End(xlToLeft).Column
Sheets("Scalability_Input").Range(Cells(scalabilityReferenceRow, "B"), Cells(scalabilityReferenceRow, lastColumn)).Copy
Sheets("targetsheet").Activate
Sheets("targetsheet").Range(Cells(2, "B"), Cells(2 + VInSertNum - 1, lastColumn)).Select
Selection.Insert Shift:=xlDown
''delete first column
Sheets("targetsheet").Cells(1, 1).EntireColumn.Delete
'xRow = xRow + VInSertNum - 1
''update columnnames
Sheets("Scalability_Input").Activate
Sheets("Scalability_Input").Range(Cells(scalabilityReferenceRow - 1, "B"), Cells(scalabilityReferenceRow - 1, lastColumn)).Copy
Sheets("targetsheet").Activate
Sheets("targetsheet").Range(Cells(1, "A"), Cells(1, lastColumn)).Select
Selection.Insert Shift:=xlToRight
  
  ''Excel Formulas
=IFERROR(VLOOKUP(G2,$B$2:$D$10000,MATCH(H$1,$B$1:$D$1,0),0),"No Data Exists")
=IFERROR(VLOOKUP(G2,$B$2:$D$10000,MATCH(I$1,$B$1:$D$1,0),0),"No Data Exists")
https://github.com/Salmankadiwal/Advanced-Excel-Formulas-and-Functions

Azure Devops
  apiURL = "https://dev.azure.com/xxxx/xxx/_apis/pipelines?api-version=6.1-preview.1"
    'apiURL = "https://dev.azure.com/pagegroup-groupservices/Global Page Test Automation/_apis/pipelines/260/runs?api-version=6.1-preview.1"
    'Set objHTTP = New MSXML2.ServerXMLHTTP60
    Set objHTTP = CreateObject("MSXML2.ServerXMLHTTP")
    objHTTP.Open "GET", apiURL, False
    objHTTP.setRequestHeader "Content-Type", "application/json"
    objHTTP.setRequestHeader "Accept", "application/json"
    objHTTP.setRequestHeader "Authorization", "Basic " & encodeBase64_1(JIRA_USER & ":" & JIRA_PWD)
    objHTTP.send
    responseText = objHTTP.responseText
    sStatus = objHTTP.Status & " | " & objHTTP.statusText
    Call PipelineName(responseText, "name")
    Call PipelineNumber(responseText, "id")

Public Function PipelineNumber(ByVal strText, ByVal strCheck)
    Dim objRegexp As RegExp
    Set objRegexp = New RegExp
    objRegexp.IgnoreCase = True
    objRegexp.Global = True
    'strText = Sheets("Data").Cells(1, 1)
    'strCheck = "id"
    strcheckexpression = "" & strCheck & """" & ":([\s\S]+?),"
    objRegexp.Pattern = strcheckexpression
    Set matches = objRegexp.Execute(strText)
    rowno = 2
    For Each Match In matches
        strReturnValue = Match.Value
        strReturnValue = Replace(strReturnValue, strText, "")
        strReturnValue = Replace(strReturnValue, """", "")
        strReturnValue = Replace(strReturnValue, ":", "")
        strReturnValue = Replace(strReturnValue, ",", "")
        strReturnValue = Replace(strReturnValue, " ", "")
        strReturnValue = Replace(strReturnValue, "id", "")
        Sheets("PipeLines").Cells(rowno, 2) = strReturnValue
      rowno = rowno + 1
    Next

    Set objRegexp = Nothing
End Function

